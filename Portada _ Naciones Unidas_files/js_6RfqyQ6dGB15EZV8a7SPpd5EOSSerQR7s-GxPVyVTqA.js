/*!
  Tinycon - A small library for manipulating the Favicon
  Tom Moor, http://tommoor.com
  Copyright (c) 2012 Tom Moor
  MIT Licensed
  @version 0.5
*/
(function(){var a={};var v=null;var q=null;var e=document.title;var m=null;var c=null;var d={};var g={width:7,height:9,font:"10px arial",colour:"#ffffff",background:"#F03D25",fallback:true,abbreviate:true};var p=(function(){var w=navigator.userAgent.toLowerCase();return function(x){return w.indexOf(x)!==-1}}());var t={ie:p("msie"),chrome:p("chrome"),webkit:p("chrome")||p("safari"),safari:p("safari")&&!p("chrome"),mozilla:p("mozilla")&&!p("chrome")&&!p("safari")};var k=function(){var x=document.getElementsByTagName("link");for(var y=0,w=x.length;y<w;y++){if((x[y].getAttribute("rel")||"").match(/\bicon\b/)){return x[y]}}return false};var j=function(){var x=document.getElementsByTagName("link");var z=document.getElementsByTagName("head")[0];for(var y=0,w=x.length;y<w;y++){var A=(typeof(x[y])!=="undefined");if(A&&(x[y].getAttribute("rel")||"").match(/\bicon\b/)){z.removeChild(x[y])}}};var i=function(){if(!q||!v){var w=k();q=v=w?w.getAttribute("href"):"/favicon.ico"}return v};var b=function(){if(!c){c=document.createElement("canvas");c.width=16;c.height=16}return c};var n=function(w){j();var x=document.createElement("link");x.type="image/x-icon";x.rel="icon";x.href=w;document.getElementsByTagName("head")[0].appendChild(x)};var f=function(w){if(window.console){window.console.log(w)}};var u=function(w,y){if(!b().getContext||t.ie||t.safari||d.fallback==="force"){return r(w)}var x=b().getContext("2d");var y=y||"#000000";var z=i();m=new Image();m.onload=function(){x.clearRect(0,0,16,16);x.drawImage(m,0,0,m.width,m.height,0,0,16,16);if((w+"").length>0){h(x,w,y)}l()};if(!z.match(/^data/)){m.crossOrigin="anonymous"}m.src=z};var r=function(w){if(d.fallback){if((w+"").length>0){document.title="("+w+") "+e}else{document.title=e}}};var h=function(A,z,D){if(typeof z=="number"&&z>99&&d.abbreviate){z=o(z)}var x=(z+"").length-1;var C=d.width+(6*x);var y=16-C;var B=16-d.height;A.font=(t.webkit?"bold ":"")+d.font;A.fillStyle=d.background;A.strokeStyle=d.background;A.lineWidth=1;A.fillRect(y,B,C-1,d.height);A.beginPath();A.moveTo(y-0.5,B+1);A.lineTo(y-0.5,15);A.stroke();A.beginPath();A.moveTo(15.5,B+1);A.lineTo(15.5,15);A.stroke();A.beginPath();A.strokeStyle="rgba(0,0,0,0.3)";A.moveTo(y,16);A.lineTo(15,16);A.stroke();A.fillStyle=d.colour;A.textAlign="right";A.textBaseline="top";A.fillText(z,15,t.mozilla?7:6)};var l=function(){if(!b().getContext){return}n(b().toDataURL())};var o=function(w){var y=[["G",1000000000],["M",1000000],["k",1000]];for(var x=0;x<y.length;++x){if(w>=y[x][1]){w=s(w/y[x][1])+y[x][0];break}}return w};var s=function(y,w){var x=new Number(y);return x.toFixed(w)};a.setOptions=function(x){d={};for(var w in g){d[w]=x.hasOwnProperty(w)?x[w]:g[w]}return this};a.setImage=function(w){v=w;l();return this};a.setBubble=function(w,x){w=w||"";u(w,x);return this};a.reset=function(){n(q)};a.setOptions(g);window.Tinycon=a})();(function(a){Drupal.behaviors.environment_indicatorToolbar={attach:function(b,e){if(typeof(e.environment_indicator)!="undefined"&&typeof(e.environment_indicator["toolbar-color"])!="undefined"){var j=e.environment_indicator["environment-indicator-name"],h=e.environment_indicator["toolbar-color"],f=e.environment_indicator["toolbar-text-color"],i=a("<div>").addClass("environment-indicator-name-wrapper").html(j),d=a("#toolbar, #navbar-bar",b);a("div.toolbar-menu",d).once("environment_indicator").prepend(i);a("div.toolbar-menu",d).css("background-color",h);a("div.toolbar-menu .item-list",d).css("background-color",changeColor(h,0.15,true));a("div.toolbar-menu ul li:not(.environment-switcher) a",d).css("background-color",h).css("color",f);a("div.toolbar-drawer",d).css("background-color",changeColor(h,0.25)).find("ul li a").css("color",changeColor(f,0.25));a("div.toolbar-menu ul li a",d).hover(function(){a(this).css("background-color",changeColor(h,0.1)).css("color",changeColor(f,0.1))},function(){a(this).css("background-color",h).css("color",f);a("div.toolbar-menu ul li.active-trail a",d).css("background-color",changeColor(h,0.1)).css("color",changeColor(f,0.1))});a("div.toolbar-menu ul li.active-trail a",d).css("background-image","none").css("background-color",changeColor(h,0.1)).css("color",changeColor(f,0.1));a("div.toolbar-drawer ul li a",d).hover(function(){a(this).css("background-color",changeColor(h,0.1,true)).css("color",changeColor(f,0.1,true))},function(){a(this).css("background-color",changeColor(h,0.25)).css("color",changeColor(f,0.25));a("div.toolbar-drawer ul li.active-trail a",d).css("background-color",changeColor(h,0.1,true)).css("color",changeColor(f,0.1,true))});a("div.toolbar-drawer ul li.active-trail a",d).css("background-image","none").css("background-color",changeColor(h,0.1,true)).css("color",changeColor(f,0.1,true));var g=a(".environment-switcher-container",d);var c=g.parent().clone();g.parent().remove();d.prepend(c);if(a("div.toolbar-menu a.toggle",d).length>0){a("div.toolbar-menu",d).css("padding-right",40)}}}};Drupal.behaviors.environment_indicatorTinycon={attach:function(b,c){if(typeof(c.environment_indicator)!="undefined"&&typeof(c.environment_indicator.addFavicon)!="undefined"&&c.environment_indicator.addFavicon){Tinycon.setBubble(c.environment_indicator.faviconLabel);Tinycon.setOptions({background:c.environment_indicator.faviconColor,colour:c.environment_indicator.faviconTextColor})}}};Drupal.behaviors.environment_indicatorAdminMenu={attach:function(b,c){if(typeof(Drupal.admin)!="undefined"&&typeof(c.environment_indicator)!="undefined"&&typeof(c.environment_indicator["toolbar-color"])!="undefined"){Drupal.admin.behaviors.environment_indicator=function(d,e){a("#admin-menu, #admin-menu-wrapper",d).css("background-color",e.environment_indicator["toolbar-color"]);a("#admin-menu, #admin-menu-wrapper > ul > li:not(.admin-menu-account) > a",d).css("color",e.environment_indicator["toolbar-text-color"]);a("#admin-menu .item-list",d).css("background-color",changeColor(e.environment_indicator["toolbar-color"],0.15,true));a("#admin-menu .item-list ul li:not(.environment-switcher) a",d).css("background-color",e.environment_indicator["toolbar-color"]).css("color",e.environment_indicator["toolbar-text-color"])}}}};Drupal.behaviors.environment_indicatorNavbar={attach:function(b,c){if(typeof(c.navbar)!="undefined"&&typeof(c.environment_indicator)!="undefined"&&typeof(c.environment_indicator["toolbar-color"])!="undefined"){a("#navbar-administration .navbar-bar",b).css("background-color",c.environment_indicator["toolbar-color"]);a("#navbar-administration .navbar-tab *:not(select)",b).css("color",c.environment_indicator["toolbar-text-color"])}}};Drupal.behaviors.environment_indicatorSwitcher={attach:function(b,c){a(".environment-switcher a",b).click(function(f){f.preventDefault();var d=window.location;window.location.href=d.protocol+"//"+f.currentTarget.hostname+d.pathname+d.search+d.hash});a("#environment-indicator .environment-indicator-name, #toolbar .environment-indicator-name-wrapper, #navbar-bar .environment-indicator-name-wrapper",b).click(function(){a("#environment-indicator .item-list, #toolbar .item-list, #navbar-bar .item-list",b).slideToggle("fast")});a("#environment-indicator.position-top.fixed-yes").once(function(){a("body").css("margin-top",a("#environment-indicator.position-top.fixed-yes").height()+"px")});a("#environment-indicator.position-bottom.fixed-yes").once(function(){a("body").css("margin-bottom",a("#environment-indicator.position-bottom.fixed-yes").height()+"px")})}};Drupal.behaviors.environment_indicator_admin={attach:function(b,c){var d=a("#environment-indicator-color-picker");if(a.isFunction(a.farbtastic)&&d.length>0){c.environment_indicator_color_picker=d.farbtastic("#ctools-export-ui-edit-item-form #edit-color");c.environment_indicator_text_color_picker=a("#environment-indicator-text-color-picker").farbtastic("#ctools-export-ui-edit-item-form #edit-text-color")}}}})(jQuery);var pad=function(b,a){var c="0";b=b+"";while(b.length<a){b=c+b}return b};var changeColor=function(b,e,h){b=b.replace(/^\s*|\s*$/,"");b=b.replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");var g=Math.round(e*256)*(h?-1:1),c=b.match(new RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),f=!!c&&c[4]!=null?c[4]:null,a=!!c?[c[1],c[2],c[3]]:b.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return parseInt(arguments[1],16)+","+parseInt(arguments[2],16)+","+parseInt(arguments[3],16)}).split(/,/),d;return !!c?"rgb"+(f!==null?"a":"")+"("+Math[h?"max":"min"](parseInt(a[0],10)+g,h?0:255)+", "+Math[h?"max":"min"](parseInt(a[1],10)+g,h?0:255)+", "+Math[h?"max":"min"](parseInt(a[2],10)+g,h?0:255)+(f!==null?", "+f:"")+")":["#",pad(Math[h?"max":"min"](parseInt(a[0],10)+g,h?0:255).toString(16),2),pad(Math[h?"max":"min"](parseInt(a[1],10)+g,h?0:255).toString(16),2),pad(Math[h?"max":"min"](parseInt(a[2],10)+g,h?0:255).toString(16),2)].join("")};var lighterColor=function(a,b){return changeColor(a,b,false)};var darkerColor=function(a,b){return changeColor(a,b,true)};